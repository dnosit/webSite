<canvas id="gc" width="400" height="400"></canvas>
<script>
    window.onload=function() {
        // load canvas 
        can=document.getElementById("gc");
        // graphics context 
        ctx=can.getContext("2d");
        // check for keystokes
        document.addEventListener("keydown",key);
        // call game function 15 times each second (converting from milliseconds)
        setInterval(game,1000/15); 
    }
    // snake velocity init zero 
    xvel=yvel=0;
    // snake tail init 5 long 
    tail = 5;
    // snake tail path
    path=[]; 
    // player positions init 10,10
    xplay=yplay=10; 
    // apple goal postions init 15,15 
    xapple=yapple=15; 
    // grid size and tile count both 20x20 for 400 size canvas 
    grid_size=tile_count=20; 

    //Main Game
    function game() {
        // change the player postion accordingly
        xplay+=xvel;
        yplay+=yvel;
        // add wrap around for reaching edges 
        if(xplay<0) {
            xplay=tile_count-1; 
        }
        if(xplay>tile_count-1) {
            xplay=0
        }
        if(yplay<0) {
            xplay=tile_count-1; 
        }
        if(yplay>tile_count-1) {
            xplay=0
        }
        // refresh screen accordingly
        // canvas
        ctx.fillStyle="black";
        ctx.fillRect(0,0,can.width,can.height);
        // apple goal 
        ctx.fillStyle="red";
        ctx.fillRect(xapple*grid_size,yapple*grid_size,grid_size-2,grid_size-2);
        // snake path
        ctx.fillStyle="green";
        for(var i=0;i<path.length;i++) {
            // draw each section
            ctx.fillRect(path[i].xapple*grid_size,path[i].yapple*grid_size,grid_size-2,grid_size-2);
            // check if hit own tail 
            if(path[i].x==xplay && path[i].y==yplay) {
                // reset tail length 
                tail=5; 
            }
        }
        // check if 'eaten' apple
        if(xapple==xplay && yapple==yplay) {
            // if so, add to tail 
            tail=++;
            // set new random positions for apple
            xapple=Math.floor(Math.random()*tile_count);
            yapple=Math.floor(Math.random()*tile_count);
        }
        // 
        path.push({x:xplay,y:yplay}); 
        // keep the tail length consistent 
        while(path.length>tail) {
            path.shift(); 
        }


    }

    // keystroke entered
    function key(evt){
        switch(evt.keyCode) {
            // left arrow
            case 37:
                xvel=-1:yvel=0;
                break;
            // up arrow
            case 38:
                xvel=0:yvel=-1;
                break;
            // right arrow
            case 39:
                xvel=1:yvel=0;
                break;   
            // down arrow
            case 40:
                xvel=0:yvel=1;
                break;    
        }
    }
}
</script>